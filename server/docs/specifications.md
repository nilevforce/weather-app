# Weather API Service

## üìå –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—É–±–ª–∏—á–Ω–æ–≥–æ API-—Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ Node.js, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Ç–µ–∫—É—â–∞—è –ø–æ–≥–æ–¥–∞, –ø—Ä–æ–≥–Ω–æ–∑, –∏—Å—Ç–æ—Ä–∏—è) —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö frontend-–∫–ª–∏–µ–Ω—Ç–æ–≤. –°–µ—Ä–≤–∏—Å —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ VPS –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —á–µ—Ä–µ–∑ REST API.

---

## üß± –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Node.js + Express.js** ‚Äî REST API
- **PostgreSQL** ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Prisma ORM** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ë–î
- **Redis** ‚Äî –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- **JWT** ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **OAuth** ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Google/Yandex
- **Swagger / OpenAPI** ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **Docker** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

---

## üìö –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### MVP

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚úÖ
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥—ã ‚úÖ
- –ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ 10 –¥–Ω–µ–π ‚úÖ
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤ ‚úÖ
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ API ‚úÖ
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ (Rate Limiting) ‚úÖ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ OAuth (Google/Yandex)

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ (–≤ –±—É–¥—É—â–µ–º)

- Email/webhook –ø–æ–¥–ø–∏—Å–∫–∏
- –ê–¥–º–∏–Ω-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–≥–æ–¥–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- GraphQL API

---

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

- JWT (access + refresh —Ç–æ–∫–µ–Ω—ã)
- OAuth –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ Google –∏ Yandex
- –ó–∞—â–∏—â—ë–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Authorization: Bearer <token>`

---

## üåê –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å—è —Ä–∞–±–æ—Ç–∞ —Å API –≤–µ–¥—ë—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å:
```
/api/v1
````

---

## üì§ –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–æ–≤

### –û—à–∏–±–∫–∞:

```json
{
  "error": {
    "message": "Invalid input params",
    "code": "VALIDATION_ERROR",
    "details": [
      {
        "field": "city",
        "message": "city is not allowed to be empty"
      }
    ]
  }
}
```

---

## üîÅ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–≥–æ–¥—ã

–í–æ–∑–º–æ–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

* `city=–ú–æ—Å–∫–≤–∞`
* `lat=55.75&lon=37.61`
* `ip=1.2.3.4` ‚Äî –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è –ø–æ IP (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π API)

–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏:

1. `lat/lon`
2. `city`
3. `ip`

---

## üì¶ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã API (`/api/v1`)

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

* `POST /auth/signup`
  –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email –∏ –ø–∞—Ä–æ–ª—é.

* `POST /auth/signin`
  –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É –ø–æ email –∏ –ø–∞—Ä–æ–ª—é.

* `POST /auth/signout`
  –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏, —É–¥–∞–ª–µ–Ω–∏–µ refresh —Ç–æ–∫–µ–Ω–∞.

* `POST /auth/oauth/google`
  –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google OAuth.

* `POST /auth/oauth/yandex`
  –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Yandex OAuth.

---

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

* `GET /users/:id`
  –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

* `PUT /users/id`
  –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–º—è, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏).

---

### –ü–æ–≥–æ–¥–∞

* `GET /weather`
  –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –ø–æ–≥–æ–¥—ã –ø–æ –≥–æ—Ä–æ–¥—É, –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –∏–ª–∏ IP.

* `GET /weather/forecast`
  –ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ 10 –¥–Ω–µ–π.

---

### –ò–∑–±—Ä–∞–Ω–Ω—ã–µ –ª–æ–∫–∞—Ü–∏–∏

* `GET /favorites`
  –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞—Ü–∏–π —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

* `POST /favorites`
  –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –ª–æ–∫–∞—Ü–∏–∏ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ.

* `DELETE /favorites/:id`
  –£–¥–∞–ª–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–∏ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ.

---

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

* `GET /stats/usage`
  –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ API. –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤.

---

### –°–ª—É–∂–µ–±–Ω—ã–µ

* `GET /ping`
  –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API (healthcheck).

* `GET /version`
  –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ API.

---

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

* –í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–ø—Ä–æ—Å–æ–≤ (rate limit).
* API –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º, —Ç–∞–∫ –∏ –∞–Ω–æ–Ω–∏–º–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ).
* –°—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
* –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–¥–∞—é—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON.

---

## üì¶ –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

* –ú–Ω–æ–≥–æ—è–∑—ã—á–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
* –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ (client-side)
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫
* –í—ã–±–æ—Ä –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
* –õ–æ–≥–∏ –∞–¥–º–∏–Ω—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

---